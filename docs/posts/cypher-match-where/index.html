<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://csaatechnicalarts.github.io/rust-graph-databases/ name=base><title>
            
                Cypher MATCH and WHERE to Find Data
            
        </title><meta content="Cypher MATCH and WHERE to Find Data" property=og:title><link href=/icon/favicon.png rel=icon type=image/png><link href=https://csaatechnicalarts.github.io/rust-graph-databases/fonts.css rel=stylesheet><script src=https://csaatechnicalarts.github.io/rust-graph-databases/js/codeblock.js></script><script src=https://csaatechnicalarts.github.io/rust-graph-databases/js/toc.js></script><script src=https://csaatechnicalarts.github.io/rust-graph-databases/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Workingman's Graph Databases " href=https://csaatechnicalarts.github.io/rust-graph-databases/atom.xml rel=alternate type=application/atom+xml><link href=https://csaatechnicalarts.github.io/rust-graph-databases/theme/light.css rel=stylesheet><link href=https://csaatechnicalarts.github.io/rust-graph-databases/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://csaatechnicalarts.github.io/rust-graph-databases/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://csaatechnicalarts.github.io/rust-graph-databases/main.css media=screen rel=stylesheet><script src="https://csaatechnicalarts.github.io/rust-graph-databases/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><div class=content><header><div class=main><a href=https://csaatechnicalarts.github.io/rust-graph-databases/>Workingman's Graph Databases </a><div class=socials><a class=social href=https://github.com/csaatechnicalarts/rust-graph-databases rel=me> <img alt=github src=https://csaatechnicalarts.github.io/rust-graph-databases/icons/social/github.svg> </a></div></div><nav><a href=https://csaatechnicalarts.github.io/rust-graph-databases/posts style=margin-left:.25em>/posts</a><a href=https://csaatechnicalarts.github.io/rust-graph-databases/tags style=margin-left:.25em>/tags</a><a href=https://csaatechnicalarts.github.io/rust-graph-databases/about style=margin-left:.25em>/about</a><button title="$SHORTCUT to open search" class=search-button id=search-button><img alt=Search class=search-icon src=https://csaatechnicalarts.github.io/rust-graph-databases/icons/search.svg></button><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><div id=modal-content><h1 class=page-header id=modalTitle>Search</h1><div id=searchBar><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search... role=combobox spellcheck=false><button title="Clear search" class=clear-button id=clear-search><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button></div><div id=results-container><div id=results-info><span id=zero_results style=display:none>No results</span><span id=one_result style=display:none>1 result</span><span id=many_results style=display:none>$NUMBER results</span></div><div id=results role=listbox></div></div></div></div><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://csaatechnicalarts.github.io/rust-graph-databases/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://csaatechnicalarts.github.io/rust-graph-databases/icons/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><main><article><div class=title><div class=page-header>Cypher MATCH and WHERE to Find Data<span class=primary-color style=font-size:1.6em>.</span></div><div class=meta>Posted on <time>2025-03-29</time> :: 378 Words <span class=tags-label>:: Tags:</span><span class=tags> <a class=post-tag href=https://csaatechnicalarts.github.io/rust-graph-databases/tags/cypher/>Cypher</a> , <a class=post-tag href=https://csaatechnicalarts.github.io/rust-graph-databases/tags/kuzudb/>KuzuDB</a> </span></div></div><div class=toc-container><h1 class=toc-title>Table of Contents</h1><ul class=toc-list><li><a href=https://csaatechnicalarts.github.io/rust-graph-databases/posts/cypher-match-where/#match>MATCH</a><li><a href=https://csaatechnicalarts.github.io/rust-graph-databases/posts/cypher-match-where/#where-and-the-as-operator>WHERE and the AS Operator</a><li><a href=https://csaatechnicalarts.github.io/rust-graph-databases/posts/cypher-match-where/#source-code>Source Code</a></ul></div><section class=body><h2 id=match><a aria-label="Anchor link for: match" class=zola-anchor href=#match>MATCH</a></h2><p>In the <a href=../../posts/cypher-create-return>preceeding post</a> we provisioned a graph network and populated it with nodes and relationships. There we saw how the Kuzu Explorer displays the graph as interconnected nodes. Alternately the browser can also presents the data in tabular form as we have here.<p><img alt src=https://csaatechnicalarts.github.io/rust-graph-databases/posts/cypher-match-where/2025_03_29-kuzugraph_city_user_table-800px.jpg><p>When we want to query for patterns in the database, we turn to Cypher's <code>MATCH</code> clause. Because Cypher is a <em>declarative language</em>, we only need to supply the pattern and leave it up to the query engine to retrive the matching data.<pre class=language-cypher data-lang=cypher data-linenos style=color:#e6e1dc;background-color:#383838><code class=language-cypher data-lang=cypher><table><tbody><tr><td>1<td><span>MATCH (u: User {name: 'Carly'})
</span><tr><td>2<td><span>RETURN u
</span></table></code></pre><p>When we run this query at the command line, Kuzu returns the matching record.<pre class=language-kuzu data-lang=kuzu style=color:#e6e1dc;background-color:#383838><code class=language-kuzu data-lang=kuzu><span>{_ID: 0:0, _LABEL: User, name: Carly, age: 31}
</span></code></pre><h2 id=where-and-the-as-operator><a aria-label="Anchor link for: where-and-the-as-operator" class=zola-anchor href=#where-and-the-as-operator>WHERE and the AS Operator</a></h2><p>In the preceeding post we also introduced <em>variable labels</em> for graph nodes. These come in handy for pattern matching in Cypher when we're using Cypher's <code>WHERE</code> clause. Combined with <code>MATCH</code>, the <code>WHERE</code> clause accepts node lables and properties as parameters for our query patterns, applying <em>pattern filters</em> that we supply.<pre class=language-cypher data-lang=cypher data-linenos style=color:#e6e1dc;background-color:#383838><code class=language-cypher data-lang=cypher><table><tbody><tr><td>1<td><span>MATCH (u: User)
</span><tr><td>2<td><span>WHERE u.name = 'Keinichi'
</span><tr><td>3<td><span>RETURN u
</span></table></code></pre><pre class=language-kuzu data-lang=kuzu style=color:#e6e1dc;background-color:#383838><code class=language-kuzu data-lang=kuzu><span>{_ID: 0:1, _LABEL: User, name: Keinichi, age: 47
</span></code></pre><p>Cypher's pattern filters come with a number of logical operators. In the example below, we apply <code>OR</code> to expand the scope of the filtered match.<pre class=language-cypher data-lang=cypher data-linenos style=color:#e6e1dc;background-color:#383838><code class=language-cypher data-lang=cypher><table><tbody><tr><td>1<td><span>MATCH (u: User)
</span><tr><td>2<td><span>WHERE u.name = 'Keinichi' OR u.name = 'Carly'
</span><tr><td>3<td><span>RETURN u.name AS PERSON
</span></table></code></pre><pre class=language-kuzu data-lang=kuzu data-linenos style=color:#e6e1dc;background-color:#383838><code class=language-kuzu data-lang=kuzu><table><tbody><tr><td>1<td><span>PERSON
</span><tr><td>2<td><span>Carly
</span><tr><td>3<td><span>Keinichi
</span></table></code></pre><p>Note that we also used another Cypher operator in that last query: <code>AS</code>. The <code>AS</code> operator lets us introduce an alias for a variable reference to make the query result more readable.<p>In our final examples we run queries against a graph network loaded with a few more informationi. Our goal here is to use patterns that traverse the <code>LivesIn</code> and/or the <code>Follows</code> relationship(s) to link a user and a city.<p><img alt src=https://csaatechnicalarts.github.io/rust-graph-databases/posts/cypher-match-where/2025_0416-kuzugraph_user_city-800px.jpg><pre class=language-cypher data-lang=cypher data-linenos style=color:#e6e1dc;background-color:#383838><code class=language-cypher data-lang=cypher><table><tbody><tr><td>1<td><span>MATCH (u: User)-[LivesIn]->(c: City)
</span><tr><td>2<td><span>WHERE u.name = 'Keinichi'
</span><tr><td>3<td><span>RETURN u.name AS USER, c.name AS CITY
</span></table></code></pre><pre class=language-cypher data-lang=cypher data-linenos style=color:#e6e1dc;background-color:#383838><code class=language-cypher data-lang=cypher><table><tbody><tr><td>1<td><span>MATCH (c: City)&LT-[LivesIn]-(u: User)
</span><tr><td>2<td><span>WHERE u.name = 'Keinichi'
</span><tr><td>3<td><span>RETURN u.name AS USER, c.name AS CITY
</span></table></code></pre><pre class=language-kuzu data-lang=kuzu style=color:#e6e1dc;background-color:#383838><code class=language-kuzu data-lang=kuzu><span>USER|CITY
</span><span>Kenichi|Sendai
</span></code></pre><p>In the first query above, we present two versions of the query, showing how flexible Cypher can be with relationship in the <code>MATCH</code> clause. The second query shows how we can chain nodes and relationships to retrieve useful information from the graph.<pre class=language-cypher data-lang=cypher data-linenos style=color:#e6e1dc;background-color:#383838><code class=language-cypher data-lang=cypher><table><tbody><tr><td>1<td><span>MATCH (u1: User)-[: Follows]->(u2: User)-[: LivesIn]->(c1: City)
</span><tr><td>2<td><span>WHERE u1.name = 'Keinichi'
</span><tr><td>3<td><span>RETURN u2.name AS PERSON, c1.name AS CITY, c1.population AS CITY_POPULATION
</span></table></code></pre><pre class=language-kuzu data-lang=kuzu style=color:#e6e1dc;background-color:#383838><code class=language-kuzu data-lang=kuzu><span>PERSON|CITY|CITY_POPULATION
</span><span>Akila|Cairo|4493410
</span><span>Klaus|Stuttgart|632865
</span></code></pre><h2 id=source-code><a aria-label="Anchor link for: source-code" class=zola-anchor href=#source-code>Source Code</a></h2><p>The code cited in this post comes from <code>kuzu_match.rs</code>. To run that however, you'll need to execute <code>kuzu_create_return.rs</code> first in order to provision a graph database and populate it with with data. <code>kuzu_create_return.rs</code> need only be executed once. Both Rust programs work with the graph database created in <code>/tmp/kuzu_db</code>.<p><a href=https://github.com/csaatechnicalarts/rust-graph-databases/blob/main/learn_cypher/src/bin/kuzu_create_return.rs>kuzu_create_return.rs</a><p><a href=https://github.com/csaatechnicalarts/rust-graph-databases/blob/main/learn_cypher/src/bin/kuzu_match.rs>kuzu_match.rs</a><hr></section></article></main></div>